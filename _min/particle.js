/*
----------------------------------------------------------------

        trƒÅma by p1xelfool

----------------------------------------------------------------
*/

let Particle=function(i,h,s,e,r,l,$,a,g,o,c){this.loc=createVector(0,h),this.vel=createVector(0,0),this.acc=createVector(0,0),this.killingTime=2,this.lifespan=700,this.index=e,this.w=r,this.h=l,this.layer=$,this.rrr=int(red(color(s))),this.ggg=int(green(color(s))),this.bbb=int(blue(color(s))),this.randGlitchX=floor(random(2,4)),this.randGlitchY=floor(random(1,2)),this.mod=a,this.modMult=g,this.GlSpeedX=o,this.GlSpeedY=c};Particle.prototype.update=function(){this.lifespan-=this.killingTime},Particle.prototype.isDead=function(){return this.lifespan<=0},Particle.prototype.applyForce=function(i){this.acc.add(i)},Particle.prototype.display=function(){for(let i=marginX;i<finalImage.width-marginX;i++){let h=int(this.loc.y),s=noise(i/40,h/40),e=int((i+h*this.w)*4),r=int((i+2*t*this.GlSpeedX+h+2*t*this.GlSpeedY*this.w)*4);this.lifespan>0?i>marginX-1&&i<finalImage.width&&h>marginY&&h<finalImage.height-marginY&&1==this.layer?i%this.modMult==0?h%this.mod==0?(tempPixels[e]=0,tempPixels[e+1]=0,tempPixels[e+2]=0,tempPixels[e+3]=255):s<1&&(tempPixels[e]=this.rrr,tempPixels[e+1]=this.ggg,tempPixels[e+2]=this.bbb,tempPixels[e+3]=255,s<noiseThresh2&&!0==hasGlitch&&(tempPixels[r]=this.rrr,tempPixels[r+2]=this.ggg,tempPixels[r+3]=this.bbb,tempPixels[r+3]=255)):h%this.mod==0&&s<1&&(tempPixels[e]=this.rrr,tempPixels[e+1]=this.ggg,tempPixels[e+2]=this.bbb,tempPixels[e+3]=255,s<noiseThresh2&&!0==this.hasGlitch&&(tempPixels[r]=this.rrr,tempPixels[r+2]=this.ggg,tempPixels[r+3]=this.bbb,tempPixels[r+3]=255)):i>marginX-1&&i<finalImage.width-marginX&&h>marginY&&h<finalImage.height-marginY&&2==this.layer&&(tempPixels[r]=this.rrr,tempPixels[r+1]=this.ggg,tempPixels[r+2]=this.bbb,tempPixels[r+3]=255):(tempPixels[e]=0,tempPixels[e+1]=0,tempPixels[e+2]=0,tempPixels[e+3]=255,tempPixels[r]=0,tempPixels[r+1]=0,tempPixels[r+2]=0,tempPixels[r+3]=255)}};